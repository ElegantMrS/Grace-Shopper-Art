{"ast":null,"code":"import _regeneratorRuntime from\"/home/danzan/.nvm/versions/node/v15.6.0/lib/node_modules/react-scripts/node_modules/@babel/runtime/regenerator\";import _slicedToArray from\"/home/danzan/.nvm/versions/node/v15.6.0/lib/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _asyncToGenerator from\"/home/danzan/.nvm/versions/node/v15.6.0/lib/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";// Rob, Joe\nimport{Link,useHistory}from\"react-router-dom\";import{loginUser}from\"./routes/index\";// import { getMyCart } from \"../api/index\";\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(_ref){var username=_ref.username,setUsername=_ref.setUsername,password=_ref.password,setPassword=_ref.setPassword,loggedIn=_ref.loggedIn,userToken=_ref.userToken,setUserToken=_ref.setUserToken,setLoggedIn=_ref.setLoggedIn;var history=useHistory();var fetchApi=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var data,token;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();_context.prev=1;_context.next=4;return loginUser(username,password);case 4:data=_context.sent;if(data.error){alert(\"Incorrect Credentials\");}else{token=data.token;localStorage.setItem(\"Token\",token);setUserToken(token);setLoggedIn(true);setUsername(username);localStorage.setItem(\"Username\",username);alert(\"You are logged in as \".concat(username));try{Promise.all([getMyRoutines(token,username)]).then(function(_ref3){var _ref4=_slicedToArray(_ref3,1),data=_ref4[0];setMyRoutines(data);});}catch(error){console.error(error);}history.push(\"/\");}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);console.error(_context.t0);case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function fetchApi(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"form\",{className:\"form-style-8\",onSubmit:fetchApi,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",minLength:\"5\",placeholder:\"Username\",value:username,onChange:function onChange(event){return setUsername(event.target.value);},required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",minLength:\"7\",placeholder:\"Password\",value:password,onChange:function onChange(event){return setPassword(event.target.value);},required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"submitRegister\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submitBtn\",children:\"Submit\"})})]})})});};export default Login;","map":{"version":3,"sources":["/home/danzan/Grace-Shopper-Art/src/components/Login.js"],"names":["Link","useHistory","loginUser","Login","username","setUsername","password","setPassword","loggedIn","userToken","setUserToken","setLoggedIn","history","fetchApi","event","preventDefault","data","error","alert","token","localStorage","setItem","Promise","all","getMyRoutines","then","setMyRoutines","console","push","target","value"],"mappings":"wcAAA;AAGA,OAASA,IAAT,CAAeC,UAAf,KAAiC,kBAAjC,CACA,OAASC,SAAT,KAA0B,gBAA1B,CACA;wFAEA,GAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,MASR,IARJC,CAAAA,QAQI,MARJA,QAQI,CAPJC,WAOI,MAPJA,WAOI,CANJC,QAMI,MANJA,QAMI,CALJC,WAKI,MALJA,WAKI,CAJJC,QAII,MAJJA,QAII,CAHJC,SAGI,MAHJA,SAGI,CAFJC,YAEI,MAFJA,YAEI,CADJC,WACI,MADJA,WACI,CAEN,GAAMC,CAAAA,OAAO,CAAGX,UAAU,EAA1B,CAEE,GAAMY,CAAAA,QAAQ,2FAAG,iBAAOC,KAAP,iIACfA,KAAK,CAACC,cAAN,GADe,sCAIMb,CAAAA,SAAS,CAACE,QAAD,CAAWE,QAAX,CAJf,QAIPU,IAJO,eAKb,GAAIA,IAAI,CAACC,KAAT,CAAgB,CACdC,KAAK,CAAC,uBAAD,CAAL,CACD,CAFD,IAEO,CACCC,KADD,CACSH,IAAI,CAACG,KADd,CAELC,YAAY,CAACC,OAAb,SAA8BF,KAA9B,EACAT,YAAY,CAACS,KAAD,CAAZ,CACAR,WAAW,CAAC,IAAD,CAAX,CACAN,WAAW,CAACD,QAAD,CAAX,CACAgB,YAAY,CAACC,OAAb,YAAiCjB,QAAjC,EACAc,KAAK,gCAAyBd,QAAzB,EAAL,CACA,GAAI,CACFkB,OAAO,CAACC,GAAR,CAAY,CAACC,aAAa,CAACL,KAAD,CAAQf,QAAR,CAAd,CAAZ,EAA8CqB,IAA9C,CAAmD,eAAY,mCAAVT,IAAU,UAC7DU,aAAa,CAACV,IAAD,CAAb,CACD,CAFD,EAGD,CAAC,MAAOC,KAAP,CAAc,CACdU,OAAO,CAACV,KAAR,CAAcA,KAAd,EACD,CACDL,OAAO,CAACgB,IAAR,CAAa,GAAb,EACD,CAvBY,+EAyBbD,OAAO,CAACV,KAAR,cAzBa,oEAAH,kBAARJ,CAAAA,QAAQ,6CAAd,CA6BA,mBACE,kCACE,kCACE,cAAM,SAAS,CAAC,cAAhB,CAA+B,QAAQ,CAAEA,QAAzC,wBACE,6BADF,cAEE,cACE,IAAI,CAAC,MADP,CAEE,SAAS,CAAC,GAFZ,CAGE,WAAW,CAAC,UAHd,CAIE,KAAK,CAAET,QAJT,CAKE,QAAQ,CAAE,kBAACU,KAAD,QAAWT,CAAAA,WAAW,CAACS,KAAK,CAACe,MAAN,CAAaC,KAAd,CAAtB,EALZ,CAME,QAAQ,KANV,EAFF,cAWE,cACE,IAAI,CAAC,UADP,CAEE,SAAS,CAAC,GAFZ,CAGE,WAAW,CAAC,UAHd,CAIE,KAAK,CAAExB,QAJT,CAKE,QAAQ,CAAE,kBAACQ,KAAD,QAAWP,CAAAA,WAAW,CAACO,KAAK,CAACe,MAAN,CAAaC,KAAd,CAAtB,EALZ,CAME,QAAQ,KANV,EAXF,cAmBE,YAAK,SAAS,CAAC,gBAAf,uBACA,eAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,WAAhC,oBADA,EAnBF,GADF,EADF,EADF,CAgCD,CA1ED,CA4EA,cAAe3B,CAAAA,KAAf","sourcesContent":["// Rob, Joe\n\n\nimport { Link, useHistory } from \"react-router-dom\";\nimport { loginUser } from \"./routes/index\";\n// import { getMyCart } from \"../api/index\";\n\nconst Login = ({\n  username,\n  setUsername,\n  password,\n  setPassword,\n  loggedIn,\n  userToken,\n  setUserToken,\n  setLoggedIn,\n}) => {\n\nconst history = useHistory();\n\n  const fetchApi = async (event) => {\n    event.preventDefault();\n\n    try {\n      const data = await loginUser(username, password);\n      if (data.error) {\n        alert(\"Incorrect Credentials\");\n      } else {\n        const token = data.token;\n        localStorage.setItem(`Token`, token);\n        setUserToken(token);\n        setLoggedIn(true);\n        setUsername(username);\n        localStorage.setItem(`Username`, username);\n        alert(`You are logged in as ${username}`);\n        try {\n          Promise.all([getMyRoutines(token, username)]).then(([data]) => {\n            setMyRoutines(data);\n          });\n        } catch (error) {\n          console.error(error);\n        }\n        history.push(\"/\");\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  return (\n    <div>\n      <div>\n        <form className=\"form-style-8\" onSubmit={fetchApi}>\n          <h2>Login</h2>\n          <input\n            type=\"text\"\n            minLength=\"5\"\n            placeholder=\"Username\"\n            value={username}\n            onChange={(event) => setUsername(event.target.value)}\n            required\n          />\n\n          <input\n            type=\"password\"\n            minLength=\"7\"\n            placeholder=\"Password\"\n            value={password}\n            onChange={(event) => setPassword(event.target.value)}\n            required\n          />\n          <div className='submitRegister'>\n          <button type=\"submit\" className=\"submitBtn\">Submit</button>\n          {/* <Link to=\"/Register\" className=\"routeLinks\">\n            Dont have an account? Register here\n          </Link> */}\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}